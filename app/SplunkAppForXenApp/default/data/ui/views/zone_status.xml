<?xml version="1.0" encoding="UTF-8"?>
<view onUnloadCancelJob="True" template="dashboard.html">
    <label>Zone Status</label>
    <module name="AccountBar" layoutPanel="appHeader" />
    <module name="AppBar" layoutPanel="appHeader" />
    <module name="SideviewUtils" layoutPanel="appHeader" />

    <module name="Message" layoutPanel="messaging">
        <param name="filter">*</param>
        <param name="clearOnJobDispatch">False</param>
        <param name="maxSize">1</param>
    </module>

    <module name="TitleBar" layoutPanel="viewHeader"/>
    <module name="GenericHeader" layoutPanel="panel_row1_col1_grp1"><param name="label">Zone Status</param></module>
    <module name="URLLoader" layoutPanel="panel_row1_col1" autoRun="true">

        <module name="TimeRangePicker" layoutPanel="panel_row1_col1_grp2">
            <param name="default">Last 60 minutes</param>
            <param name="searchWhenChanged">true</param>

            <module name="Search">
                <param name="search"><![CDATA[ `xenapp_index` `xa_zone_sourcetype` | eval ZoneName=upper(ZoneName) | stats count by ZoneName | table ZoneName ]]></param>
                <module name="Pulldown" layoutPanel="panel_row1_col1_grp3">
                    <param name="name">ZoneName</param>
                    <param name="size">1</param>
                    <param name="width">300px</param>
                    <param name="staticFieldsToDisplay"></param>
                    <param name="label">Zone Name:</param>
                    <param name="searchFieldsToDisplay">
                        <list>
                            <param name="label">ZoneName</param>
                            <param name="value">ZoneName</param>
                        </list>
                    </param>

                    <module name="GenericHeader" layoutPanel="panel_row2_col1">
                        <param name="label">Farm Data</param>
                        <module name="Search">
                            <param name="search"><![CDATA[ `xenapp_index` `xa_farm_sourcetype` | lookup xa_zone_farm FarmName | search ZoneName="$ZoneName$" | stats first(Users) as Users first(SessionCount) as Sessions first(Servers) as Servers first(AdministratorType) as AdminType by FarmName | Transpose ]]></param>
                            <module name="SimpleResultsTable">
                                <param name="drilldown">row</param>
                            </module> <!-- SimpleResultsTable -->
                        </module> <!-- Search -->
                    </module> <!-- Search -->

                    <module name="GenericHeader" layoutPanel="panel_row2_col1">
                        <param name="label">Zone Data</param>
                        <module name="Search">
                            <param name="search"><![CDATA[ `xenapp_index` `xa_zone_sourcetype` ZoneName="$ZoneName$" | stats first(DataCollector) as DataCollector first(FarmName) as FarmName by ZoneName ]]></param>
                            <module name="SimpleResultsTable">
                                <param name="drilldown">row</param>
                            </module> <!-- SimpleResultsTable -->
                        </module> <!-- Search -->
                    </module> <!-- Search -->

                    <module name="GenericHeader" layoutPanel="panel_row2_col2">
                        <param name="label">Servers</param>
                        <module name="Search">
                            <param name="search"><![CDATA[ `xenapp_index` `xa_server_sourcetype` ZoneName="$ZoneName$" | stats first(CitrixProductName) as Product first(CitrixVersion) as Version first(CitrixEdition) as Edition first(LogOnsEnabled) as LogonEnabled first(ZoneName) as ZoneName by ServerName ]]></param>
                            <module name="SimpleResultsTable">
                                <param name="drilldown">row</param>
                                <module name="Redirector">
                                    <param name="url">server_status</param>
                                    <param name="arg.autoRun">True</param>
                                    <param name="arg.ServerName">$click.fields.ServerName$</param>
                                    <param name="arg.earliest">$search.timeRange.earliest$</param>
                                    <param name="arg.latest">$search.timeRange.latest$</param>
                                </module> <!-- Redirector#Drill Down -->
                            </module> <!-- SimpleResultsTable -->
                        </module> <!-- Search -->
                    </module> <!-- GenericHeader -->


                    <module name="GenericHeader" layoutPanel="panel_row3_col1">
                        <param name="label">Applications</param>
                        <module name="Search">
                            <param name="search"><![CDATA[ `xenapp_index` `xa_application_sourcetype` | lookup xa_zone_farm FarmName | search ZoneName="$ZoneName$" | stats first(DisplayName) as DisplayName first(Description) as Description first(ApplicationType) as Type first(FolderPath) as FolderPath by BrowserName ]]></param>
                            <module name="Pager">
                                <param name="entityName">results</param>
                                <module name="SimpleResultsTable">
                                    <param name="displayMenu">true</param>
                                    <param name="count">100</param>
                                </module>
                            </module>
                        </module> <!-- Search -->
                    </module> <!-- GenericHeader -->

                </module> <!-- Pulldown#host -->
            </module> <!-- Search#host Pulldown -->
        </module> <!-- TimeRangePicker -->
    </module> <!-- URLLoader -->
</view>
