<?xml version="1.0" encoding="UTF-8"?>
<view onUnloadCancelJob="True" template="dashboard.html">
	<label>Server Status</label>
	<module name="AccountBar" layoutPanel="appHeader" />
	<module name="AppBar" layoutPanel="appHeader" />
	<module name="SideviewUtils" layoutPanel="appHeader" />

	<module name="Message" layoutPanel="messaging">
		<param name="filter">*</param>
		<param name="clearOnJobDispatch">False</param>
		<param name="maxSize">1</param>
	</module>

	<module name="TitleBar" layoutPanel="viewHeader"/>
	<!--<module name="GenericHeader" layoutPanel="panel_row1_col1_grp1"><param name="label">Server Status</param></module>-->
	<module name="URLLoader" layoutPanel="viewHeader" autoRun="true">

		<module name="TimeRangePicker" layoutPanel="viewHeader">
			<param name="default">Last 60 minutes</param>
			<param name="searchWhenChanged">true</param>

			<module name="Search">
				<param name="search"><![CDATA[ | inputlookup xa_zone_farm | search ServerName="$ServerName$" |eval ServerName=upper(ServerName) | stats count by ServerName | table ServerName ]]></param>
				<module name="Pulldown" layoutPanel="viewHeader">
					<param name="name">host</param>
					<param name="size">1</param>
					<param name="width">300px</param>
					<param name="staticFieldsToDisplay"></param>
					<param name="label">Server Name:</param>
					<param name="searchFieldsToDisplay">
						<list>
							<param name="label">ServerName</param>
							<param name="value">ServerName</param>
						</list>
					</param>

					<module name="GenericHeader" layoutPanel="panel_row2_col1">
						<param name="label">OS Data</param>
						<module name="Search">
							<param name="search"><![CDATA[ `xenapp_index` `xa_server_sourcetype` ServerName="$host$" | stats latest(OSVersion) as OSVersion latest(OSServicePack) as ServicePack latest(IPAddresses) as IP latest(Is64Bit) as Is64Bit earliest(*) as junk_* by ServerName | `remove_junk` | Transpose]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- Search -->

					<module name="GenericHeader" layoutPanel="panel_row2_col1">
						<param name="label">Citrix Data</param>
						<module name="Search">
							<param name="search"><![CDATA[ `xenapp_index` `xa_server_sourcetype` ServerName="$host$" | stats latest(SessionCount) as Sessions latest(LogOnsEnabled) as LogonEnabled latest(CitrixProductName) as Product latest(CitrixEdition) as Edition latest(CitrixInstallDate) as InstallDate latest(FarmName) as FarmName latest(ZoneName) as ZoneName latest(ElectionPreference) as ElectionPreference earliest(*) as junk_* by ServerName | `remove_junk` | Transpose]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- Search -->

					<module name="GenericHeader" layoutPanel="panel_row2_col2">
						<param name="label">OS Performance</param>
						<module name="Search">
							<param name="search"><![CDATA[ `perfmon_index` host="$host$" sourcetype="Perfmon:CPULoad" OR sourcetype="PerfMon:AvailableMemory" OR sourcetype="PerfMon:*Disk*" | stats sparkline(avg(Value)) as "Average", avg(Value) as "Average Value" by counter | sort counter | rename counter as "Performance Counter" ]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
								<module name="Redirector">
									<param name="url">performance</param>
									<param name="arg.autoRun">True</param>
									<param name="arg.object">NTDS</param>
									<param name="arg.counter">$click.cell0.value$</param>
									<param name="arg.host">$host$</param>
									<param name="arg.earliest">$search.timeRange.earliest$</param>
									<param name="arg.latest">$search.timeRange.latest$</param>
								</module> <!-- Redirector#Drill Down -->
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->

					<module name="GenericHeader" layoutPanel="panel_row2_col2">
						<param name="label">Network Performance</param>
						<module name="Search">
							<param name="search"><![CDATA[ `perfmon_index` host="$host$" sourcetype="Perfmon:NetworkInterface" | stats sparkline(avg(Value)) as "Average", avg(Value) as "Average Value" by counter | sort counter | rename counter as "Performance Counter" ]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
								<module name="Redirector">
									<param name="url">performance</param>
									<param name="arg.autoRun">True</param>
									<param name="arg.object">NTDS</param>
									<param name="arg.counter">$click.cell0.value$</param>
									<param name="arg.host">$host$</param>
									<param name="arg.earliest">$search.timeRange.earliest$</param>
									<param name="arg.latest">$search.timeRange.latest$</param>
								</module> <!-- Redirector#Drill Down -->
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->

					<module name="GenericHeader" layoutPanel="panel_row3_col1">
						<param name="label">Windows Events</param>
						<module name="Search">
							<param name="search"><![CDATA[ `win_index` sourcetype="WinEventLog:*" host="$host$" | stats count by Type,EventCode,LogName,Message ]]></param>
							<module name="Pager">
								<param name="entityName">results</param>
								<module name="SimpleResultsTable">
									<param name="drilldown">row</param>
									<module name="Redirector">
										<param name="url">flashtimeline</param>
										<param name="arg.autoRun">True</param>
										<param name="arg.q"><![CDATA[ `win_index` sourcetype="WinEventLog:*" host="$host$" Type="$click.cell0.value$" EventCode="$click.cell1.value$" LogName="$click.cell2.value$" ]]></param>
										<param name="arg.earliest">$search.timeRange.earliest$</param>
										<param name="arg.latest">$search.timeRange.latest$</param>
									</module>
								</module>
							</module>	
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->

				</module> <!-- Pulldown#host -->
			</module> <!-- Search#host Pulldown -->
		</module> <!-- TimeRangePicker -->
	</module> <!-- URLLoader -->
</view>
